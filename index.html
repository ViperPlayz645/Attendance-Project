<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Attendance Check</title>
    <style>
      body { font-family: Arial, sans-serif; text-align:center; padding:40px; }
      input { padding:8px; width:80%; max-width:300px; margin:10px 0; }
      button { padding:10px 20px; }
      #result { margin-top:20px; font-weight:bold; }
    </style>
  </head>
  <body>
    <h2>Attendance Verification</h2>
    <p>Enter your full name to check in:</p>
    <input id="name" placeholder="Full name">
    <br>
    <button onclick="verify()">Submit</button>
    <p id="status">Checking GPS access…</p>
    <p id="result"></p>

    <script>
      const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby0bgAkSABClWgfkzDybNk1FviydN0XJhUgqKbtrVLNX7-lzexF5xpC372H3pSNtnMupw/exec";

      function verify() {
        const name = document.getElementById("name").value.trim();
        if (!name) return alert("Please enter your name.");

        if (navigator.geolocation) {
          document.getElementById("status").innerText = "Getting location...";
          navigator.geolocation.getCurrentPosition(
            pos => {
              const lat = pos.coords.latitude;
              const lon = pos.coords.longitude;
              console.log(`Latitude: ${pos.coords.latitude}, Longitude: ${pos.coords.longitude}`);
              document.getElementById("status").innerText = `Location found: ${lat.toFixed(5)}, ${lon.toFixed(5)} — verifying...`;
    
              fetch(`${WEB_APP_URL}?name=${encodeURIComponent(name)}&lat=${lat}&lon=${lon}`)
              .then(r => r.text())
              .then(txt => {
                document.getElementById("status").innerText = "";
                document.getElementById("result").innerText = txt;
              })
              .catch(err => {
                document.getElementById("status").innerText = "";
                document.getElementById("result").innerText = "⚠️ Server error: " + err.message;
              });
          },
          error => {
              switch(error.code) {
                  case error.PERMISSION_DENIED:
                  document.getElementById("status").innerText = "❌ Permission denied. Please allow location access.";
                  break;
              case error.POSITION_UNAVAILABLE:
                  document.getElementById("status").innerText = "⚠️ Location unavailable.";
                  break;
              case error.TIMEOUT:
                  document.getElementById("status").innerText = "⏱️ Location request timed out.";
                  break;
              default:
                  document.getElementById("status").innerText = "❌ Unknown error getting location.";
            }
          },
          { timeout: 10000 } // 10 seconds
        );
        } else {
          alert("Geolocation not supported.");
        }
      }
    </script>
  </body>
</html>









